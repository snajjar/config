<style>
.add-node-modal .modal-body {
    height: 70vh;
}

.h100 {
    height: 100%!important;
    min-height: 100%!important;
}

.module-name {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;
}

.module-show-description, .module-show-inputs, .module-show-outputs, .module-show-attributes {
    margin-top: 20px;
    display: none;
    font-size: 14px;
}

.table-desc th, .table-desc td {
    margin-right: 10px;
}

#add-node-modal .modal-dialog {
  min-width: calc(100% - 40px)!important;
  height: calc(100% - 40px);
  margin: 20px;
  padding: 0;
}

#add-node-modal .modal-content {
  height: auto;
  min-height: 100%;
  border-radius: 0;
}

.node-description {
    max-height: 100%;
    overflow-y: scroll;
    overflow-x: hidden;
    padding-right: 15px;
}
</style>

<template>
    <div class="modal fade add-node-modal" id="add-node-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content h100">
                <div class="modal-header">
                    <h5 class="modal-title">Add a new Module</h5>

                    <div class="mx-auto">
                        <input class="form-control mx-auto search-modules" type="text" placeholder="Search modules..." id="search-nodes" style="width: 300px;"/>
                    </div>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="container-fluid h100">
                        <div class="row h100">
                            <div class="col-md-4 h100" style="padding-left: 0; padding-right: 0;">
                                <div class="search-nodes-results h100"></div>
                            </div>
                            <div class="col-md-8 h100" style="padding-left: 15px; padding-right: 0;">
                                <div class="node-description h100">
                                    <div class="row">
                                        <div class="col-md-4 module-show">
                                            <div class="module-name"></div>
                                            <div class="module-signature" id="module-signature"></div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="module-show-description">
                                                <label style="text-decoration: underline;">Description: </label>
                                                <div class="module-long-description"></div>
                                            </div>
                                        </div>
                                        <hr/>
                                    </div>

                                    <div class="module-show-inputs">
                                        <label style="text-decoration: underline;">Inputs: </label>
                                        <div class="module-inputs"></div>
                                    </div>

                                    <div class="module-show-outputs">
                                        <label style="text-decoration: underline;">Outputs: </label>
                                        <div class="module-outputs"></div>
                                    </div>

                                    <div class="module-show-attributes">
                                        <label style="text-decoration: underline;">Attributes: </label>
                                        <div class="module-attributes"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary add-node-btn" v-on:click="addSelectedNode">Add node</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
import _ from 'lodash';
import swal from 'sweetalert2';
import SearchResultsVue from './searchResults.vue';

export default {
    props: [
        "view",
    ],
    components: {
        'searchResults' : SearchResultsVue
    },
    data: function () {
        return {
        }
    },
    created: function() {

    },
    mounted: function() {

    },
    methods: {
        addSelectedNode: function(e) {
            var selectedNode = $('.node-result.selected')[0];
            if( selectedNode ) {
                // add node to the controller
                var packageName = $(selectedNode).data('package');
                this.view.c.addNewBox(packageName);
            }
            else {
                swal('Please select a node', '', 'error');
                return;
            }
        }
    }
}

    /* TODO
    // bind the search to the search input
    $('.search-modules').on("input", (e) => {
        var text = $('.search-modules').val();
        var resultDiv = $('.search-nodes-results');
        resultDiv.empty().append('<p>Searching...</p>');
        view.e.search(text).catch( (err) => {
            swal('error searching packages', err.reason, "error");
        }).then((results) => {
            view.templateMgr.replaceTemplate(resultDiv, "searchResults", { results: results });
        });
    });
    */

</script>

